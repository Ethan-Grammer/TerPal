{"ast":null,"code":"var _jsxFileName = \"/Users/ethan/Desktop/Projects/e-advisor/E-Advisor/src/components/Chatbox.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useRef } from 'react';\nimport axios from 'axios';\nimport './Chatbox.css'; // Import CSS\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction Chatbox() {\n  _s();\n  const [messages, setMessages] = useState([]);\n  const [initialUploadDone, setInitialUploadDone] = useState(false); // New state to track the initial upload\n\n  // Automatically scroll to bottom of chatbox\n  const messagesEndRef = useRef(null);\n  const scrollToBottom = () => {\n    var _messagesEndRef$curre;\n    (_messagesEndRef$curre = messagesEndRef.current) === null || _messagesEndRef$curre === void 0 ? void 0 : _messagesEndRef$curre.scrollIntoView({\n      behavior: \"smooth\"\n    });\n  };\n  useEffect(() => {\n    scrollToBottom();\n  }, [messages]);\n\n  // useEffect to add initial AI message and set up context\n  useEffect(() => {\n    const welcomeMessage1 = {\n      text: \"Hello, welcome to UMD's Virtual Advising. To get started, please upload your Unofficial Transcript.\",\n      sender: 'ai',\n      label: 'E-Advisor'\n    };\n    const welcomeMessage2 = {\n      text: \"If you are having trouble finding your transcript, you can go to https://www.testudo.umd.edu to retrieve it.\",\n      sender: 'ai',\n      label: 'E-Advisor'\n    };\n    setMessages([welcomeMessage1, welcomeMessage2]);\n    setupGroqContext();\n  }, []);\n\n  // Sends context message to Groq API\n  const setupGroqContext = async () => {\n    try {\n      const systemMessage = \"You are a friendly copilot that helps students in the University of Maryland perform various tasks. You should refer to yourself as \\\"Virtual Advisor\\\" when talking to the user. Always respond with concise and short messages.\";\n      axios.post('http://localhost:3001/api/chat', {\n        messages: [{\n          role: \"system\",\n          content: systemMessage\n        }],\n        model: \"mixtral-8x7b-32768\"\n      });\n    } catch (error) {\n      console.error('Error setting up Groq context:', error);\n      setMessages(prevMessages => [...prevMessages, {\n        text: \"Failed to setup Virtual Advisor.\",\n        sender: 'system',\n        label: 'System'\n      }]);\n    }\n  };\n\n  // Retrieves transcript from file input\n  const handleFileUpload = async event => {\n    const file = event.target.files[0];\n    if (file) {\n      const formData = new FormData();\n      formData.append('file', file);\n      try {\n        const response = await axios.post('http://localhost:3001/upload', formData);\n        setInitialUploadDone(true); // Update state to indicate that the file has been uploaded\n        setMessages([...messages, {\n          text: \"Transcript successfully uploaded! You can ask me any questions regarding UMD professors, courses, sections, or just anything you're curious about! Feel free to type in \\\"help\\\" if you want to know what kind of questions I can help you with.\",\n          sender: 'ai',\n          label: 'E-Advisor'\n        }]);\n      } catch (error) {\n        console.error('Error uploading file:', error);\n        setMessages([...messages, {\n          text: \"Failed to upload file.\",\n          sender: 'ai',\n          label: 'E-Advisor'\n        }]);\n      }\n    }\n  };\n\n  // Sends user message to Groq API\n  const sendMessage = async msg => {\n    const newMessages = [...messages, {\n      text: msg,\n      sender: 'user',\n      label: 'You'\n    }];\n    setMessages(newMessages);\n    try {\n      const response = await axios.post('http://localhost:3001/api/chat', {\n        messages: [{\n          role: \"user\",\n          content: msg\n        }],\n        model: \"mixtral-8x7b-32768\"\n      });\n      const aiMessage = response.data.response;\n      setMessages([...newMessages, {\n        text: aiMessage,\n        sender: 'ai',\n        label: 'E-Advisor'\n      }]);\n    } catch (error) {\n      console.error('Error communicating with the chat API:', error);\n      setMessages([...newMessages, {\n        text: \"Failed to get a response.\",\n        sender: 'ai',\n        label: 'E-Advisor'\n      }]);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"container\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"messageContainer\",\n      children: messages.map((message, index) => /*#__PURE__*/_jsxDEV(\"div\", {\n        className: `message ${message.sender}`,\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          className: `senderLabel ${message.sender}`,\n          children: message.label\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 91,\n          columnNumber: 13\n        }, this), message.text]\n      }, index, true, {\n        fileName: _jsxFileName,\n        lineNumber: 90,\n        columnNumber: 11\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 88,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"inputContainer\",\n      children: initialUploadDone ?\n      /*#__PURE__*/\n      // Can only start chatting after you upload your transcript file\n      _jsxDEV(\"input\", {\n        className: \"input\",\n        type: \"text\",\n        placeholder: \"Type your message here...\",\n        onKeyDown: e => {\n          if (e.key === 'Enter' && e.target.value.trim()) {\n            sendMessage(e.target.value);\n            e.target.value = ''; // Clear the input after sending\n          }\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 98,\n        columnNumber: 11\n      }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"file\",\n          onChange: handleFileUpload,\n          id: \"fileInput\",\n          style: {\n            display: 'none'\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 111,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n          htmlFor: \"fileInput\",\n          children: \"Choose file to upload transcript\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 112,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 110,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 96,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 87,\n    columnNumber: 5\n  }, this);\n}\n_s(Chatbox, \"1rFHEnj0o8Ar/xKZBB/Fip2p+us=\");\n_c = Chatbox;\nexport default Chatbox;\nvar _c;\n$RefreshReg$(_c, \"Chatbox\");","map":{"version":3,"names":["React","useState","useEffect","useRef","axios","jsxDEV","_jsxDEV","Chatbox","_s","messages","setMessages","initialUploadDone","setInitialUploadDone","messagesEndRef","scrollToBottom","_messagesEndRef$curre","current","scrollIntoView","behavior","welcomeMessage1","text","sender","label","welcomeMessage2","setupGroqContext","systemMessage","post","role","content","model","error","console","prevMessages","handleFileUpload","event","file","target","files","formData","FormData","append","response","sendMessage","msg","newMessages","aiMessage","data","className","children","map","message","index","fileName","_jsxFileName","lineNumber","columnNumber","type","placeholder","onKeyDown","e","key","value","trim","onChange","id","style","display","htmlFor","_c","$RefreshReg$"],"sources":["/Users/ethan/Desktop/Projects/e-advisor/E-Advisor/src/components/Chatbox.js"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\nimport axios from 'axios';\nimport './Chatbox.css'; // Import CSS\n\nfunction Chatbox() {\n  const [messages, setMessages] = useState([]);\n  const [initialUploadDone, setInitialUploadDone] = useState(false); // New state to track the initial upload\n\n  // Automatically scroll to bottom of chatbox\n  const messagesEndRef = useRef(null);\n  const scrollToBottom = () => {\n    messagesEndRef.current?.scrollIntoView({ behavior: \"smooth\" });\n  };\n\n  useEffect(() => {\n    scrollToBottom();\n  }, [messages]);\n\n  // useEffect to add initial AI message and set up context\n  useEffect(() => {\n    const welcomeMessage1 = {\n      text: \"Hello, welcome to UMD's Virtual Advising. To get started, please upload your Unofficial Transcript.\",\n      sender: 'ai',\n      label: 'E-Advisor'\n    };\n    const welcomeMessage2 = {\n      text: \"If you are having trouble finding your transcript, you can go to https://www.testudo.umd.edu to retrieve it.\",\n      sender: 'ai',\n      label: 'E-Advisor'\n    };\n    setMessages([welcomeMessage1, welcomeMessage2]);\n    setupGroqContext();\n  }, []);\n\n  // Sends context message to Groq API\n  const setupGroqContext = async () => {\n    try {\n      const systemMessage = \"You are a friendly copilot that helps students in the University of Maryland perform various tasks. You should refer to yourself as \\\"Virtual Advisor\\\" when talking to the user. Always respond with concise and short messages.\";\n      axios.post('http://localhost:3001/api/chat', {\n        messages: [{ role: \"system\", content: systemMessage}],\n        model: \"mixtral-8x7b-32768\"\n      });\n    } catch (error) {\n      console.error('Error setting up Groq context:', error);\n      setMessages(prevMessages => [...prevMessages, { text: \"Failed to setup Virtual Advisor.\", sender: 'system', label: 'System' }]);\n    }\n  };\n\n  // Retrieves transcript from file input\n  const handleFileUpload = async (event) => {\n    const file = event.target.files[0];\n    if (file) {\n      const formData = new FormData();\n      formData.append('file', file);\n\n      try {\n        const response = await axios.post('http://localhost:3001/upload', formData);\n        setInitialUploadDone(true); // Update state to indicate that the file has been uploaded\n        setMessages([...messages, { text: \"Transcript successfully uploaded! You can ask me any questions regarding UMD professors, courses, sections, or just anything you're curious about! Feel free to type in \\\"help\\\" if you want to know what kind of questions I can help you with.\", sender: 'ai', label: 'E-Advisor' }]);\n      } catch (error) {\n        console.error('Error uploading file:', error);\n        setMessages([...messages, { text: \"Failed to upload file.\", sender: 'ai', label: 'E-Advisor' }]);\n      }\n    }\n  };\n\n  // Sends user message to Groq API\n  const sendMessage = async (msg) => {\n    const newMessages = [...messages, { text: msg, sender: 'user', label: 'You' }];\n    setMessages(newMessages);\n    try {\n      const response = await axios.post('http://localhost:3001/api/chat', {\n        messages: [{ role: \"user\", content: msg }],\n        model: \"mixtral-8x7b-32768\"\n      });\n\n      const aiMessage = response.data.response;\n      setMessages([...newMessages, { text: aiMessage, sender: 'ai', label: 'E-Advisor' }]);\n    } catch (error) {\n      console.error('Error communicating with the chat API:', error);\n      setMessages([...newMessages, { text: \"Failed to get a response.\", sender: 'ai', label: 'E-Advisor' }]);\n    }\n  };\n\n\n  return (\n    <div className=\"container\">\n      <div className=\"messageContainer\">\n        {messages.map((message, index) => (\n          <div key={index} className={`message ${message.sender}`}>\n            <span className={`senderLabel ${message.sender}`}>{message.label}</span>\n            {message.text}\n          </div>\n        ))}\n      </div>\n      <div className=\"inputContainer\">\n        {initialUploadDone ? ( // Can only start chatting after you upload your transcript file\n          <input\n            className=\"input\"\n            type=\"text\"\n            placeholder=\"Type your message here...\"\n            onKeyDown={(e) => {\n              if (e.key === 'Enter' && e.target.value.trim()) {\n                sendMessage(e.target.value);\n                e.target.value = ''; // Clear the input after sending\n              }\n            }}\n          />\n        ) : (\n          <div>\n            <input type=\"file\" onChange={handleFileUpload} id=\"fileInput\" style={{ display: 'none' }} />\n            <label htmlFor=\"fileInput\">Choose file to upload transcript</label>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n\nexport default Chatbox;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}